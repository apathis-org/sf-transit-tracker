<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SF Transit Tracker - Route-Aware</title>
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <!-- Socket.IO client library (provides HTTP polling for real-time updates) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    
    <!-- Default theme with exact original styles -->
    <link rel="stylesheet" href="/static/themes/default/default-theme.css">
</head>
<body>
    <div id="map"></div>

    <div class="panel unified-status-panel" id="unified-status">
        <div class="status-indicator" id="status">
            <div class="status-dot connecting"></div>
            <span id="connection-text">Connecting...</span>
        </div>
        <div class="status-details" id="status-details">
            <span id="vehicle-count">0 vehicles</span> ‚Ä¢ 
            <span id="agency-count">0 agencies</span> ‚Ä¢ 
            <span id="routes-count">0 routes (0 route aware)</span> ‚Ä¢ 
            <span id="last-update">Last update: --:--</span>
        </div>
    </div>

    <!-- Mobile Filter Toggle Button -->
    <button class="filter-toggle" id="filter-toggle" aria-label="Toggle Filters">
        <span class="hamburger"></span>
        <span class="hamburger"></span>
        <span class="hamburger"></span>
    </button>

    <div class="panel filter-panel" id="filter-panel">
        <div class="filter-header">
            <h3 style="color: rgba(255,255,255,0.9); margin-bottom: 10px; font-weight: 600;">üéõÔ∏è Filters</h3>
            <button class="filter-close" id="filter-close" aria-label="Close Filters">‚úï</button>
        </div>

        <div class="filter-group">
            <h4>SFMTA (San Francisco)</h4>
            <div class="filter-item">
                <input type="checkbox" id="filter-muni-bus" checked>
                <span class="filter-name">Muni Buses</span>
                <span class="filter-count" id="count-muni-bus">0</span>
            </div>
            <div class="filter-item">
                <input type="checkbox" id="filter-light-rail" checked>
                <span class="filter-name">Light Rail</span>
                <span class="filter-count" id="count-light-rail">0</span>
            </div>
            <div class="filter-item">
                <input type="checkbox" id="filter-cable-car">
                <span class="filter-name">Cable Cars</span>
                <span class="filter-count" id="count-cable-car">0</span>
            </div>
        </div>

        <div class="filter-group">
            <h4>BART</h4>
            <div class="filter-item">
                <input type="checkbox" id="filter-bart-train">
                <span class="filter-name">BART Trains</span>
                <span class="filter-count" id="count-bart-train">0</span>
            </div>
        </div>

        <div class="filter-group">
            <h4>Golden Gate</h4>
            <div class="filter-item">
                <input type="checkbox" id="filter-gg-bus">
                <span class="filter-name">GG Buses</span>
                <span class="filter-count" id="count-gg-bus">0</span>
            </div>
            <div class="filter-item">
                <input type="checkbox" id="filter-ferry">
                <span class="filter-name">Ferries</span>
                <span class="filter-count" id="count-ferry">0</span>
            </div>
        </div>

        <div class="filter-group">
            <h4>AC Transit</h4>
            <div class="filter-item">
                <input type="checkbox" id="filter-ac-bus">
                <span class="filter-name">AC Buses</span>
                <span class="filter-count" id="count-ac-bus">0</span>
            </div>
        </div>

        <div class="filter-group bay-area-section">
            <div class="bay-area-header" id="bay-area-toggle">
                <h4>Bay Area Regions <span class="collapse-icon">‚ñ∂</span></h4>
            </div>
            <div class="bay-area-content" id="bay-area-content" style="display: none;">
                <div class="filter-item">
                    <input type="checkbox" id="filter-caltrain" checked>
                    <span class="filter-name">Caltrain</span>
                    <span class="filter-count" id="count-caltrain">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-capitol-corridor">
                    <span class="filter-name">Capitol Corridor</span>
                    <span class="filter-count" id="count-capitol-corridor">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-ace-train">
                    <span class="filter-name">ACE Train</span>
                    <span class="filter-count" id="count-ace-train">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-smart-rail">
                    <span class="filter-name">SMART Rail</span>
                    <span class="filter-count" id="count-smart-rail">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-sf-bay-ferry">
                    <span class="filter-name">SF Bay Ferry</span>
                    <span class="filter-count" id="count-sf-bay-ferry">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-vta">
                    <span class="filter-name">VTA</span>
                    <span class="filter-count" id="count-vta">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-samtrans">
                    <span class="filter-name">SamTrans</span>
                    <span class="filter-count" id="count-samtrans">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-tri-delta">
                    <span class="filter-name">Tri Delta Transit</span>
                    <span class="filter-count" id="count-tri-delta">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-county-connection">
                    <span class="filter-name">County Connection</span>
                    <span class="filter-count" id="count-county-connection">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-marin-transit">
                    <span class="filter-name">Marin Transit</span>
                    <span class="filter-count" id="count-marin-transit">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-dumbarton-express">
                    <span class="filter-name">Dumbarton Express</span>
                    <span class="filter-count" id="count-dumbarton-express">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-emery-go-round">
                    <span class="filter-name">Emery Go-Round</span>
                    <span class="filter-count" id="count-emery-go-round">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-fs-transit">
                    <span class="filter-name">FS Transit</span>
                    <span class="filter-count" id="count-fs-transit">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-mv-transportation">
                    <span class="filter-name">MV Transportation</span>
                    <span class="filter-count" id="count-mv-transportation">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-presidio-go">
                    <span class="filter-name">Presidio Go</span>
                    <span class="filter-count" id="count-presidio-go">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-sonoma-county">
                    <span class="filter-name">Sonoma County Transit</span>
                    <span class="filter-count" id="count-sonoma-county">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-sonoma-county-sr">
                    <span class="filter-name">Sonoma County Transit (SR)</span>
                    <span class="filter-count" id="count-sonoma-county-sr">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-soltrans">
                    <span class="filter-name">SolTrans</span>
                    <span class="filter-count" id="count-soltrans">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-union-city">
                    <span class="filter-name">Union City Transit</span>
                    <span class="filter-count" id="count-union-city">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-vacaville">
                    <span class="filter-name">Vacaville City Coach</span>
                    <span class="filter-count" id="count-vacaville">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-vine-transit">
                    <span class="filter-name">Vine Transit</span>
                    <span class="filter-count" id="count-vine-transit">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-westcat">
                    <span class="filter-name">WestCAT</span>
                    <span class="filter-count" id="count-westcat">0</span>
                </div>
                <div class="filter-item">
                    <input type="checkbox" id="filter-wheels">
                    <span class="filter-name">Wheels</span>
                    <span class="filter-count" id="count-wheels">0</span>
                </div>
            </div>
        </div>
    </div>


    <!-- External Libraries -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    
    <!-- Modular JavaScript -->
    <script src="/static/routeManager.js"></script>
    <script src="/static/js/TransitTracker.js"></script>
    
    <!-- Filter toggle functionality now handled by TransitTracker.js -->

    <!-- Application Initialization -->
    <script>
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.tracker = new TransitTracker();
        });
    </script>
</body>
</html>